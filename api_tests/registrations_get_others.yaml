# Test generated by RoostGPT for test credential-wallet-rest-assured using AI Type Azure Open AI and AI Model roost-gpt4-32k


# RoostTestHash=49b35fa9c1

config:
  target: "{{ $processEnvironment.API_HOST }}"
  ensure:
    - statusCode 200
  plugins:
    expect: {}
  payload:
    path: "registrations_get_others.csv"
    fields: ["id", "credential-url", "size", "offset"]
    skipHeader: true

scenarios:
  - name: "Test Non-Success Responses"
    flow:
      - log: "Post to /recipients/branches/{id}/registration with invalid payload"
        post:
          url: "/recipients/branches/{{ id }}/registration"
          json:
            nonexistent: "invalid"
          headers:
            Authorization: "Bearer {{$processEnvironment.AUTH_TOKEN}}"
          expect:
            - statusCode 400
            - hasHeader: api-version
            - contentType: json
        think: 3

      - log: "Put to /recipients/branches/{id}/registration with payload that will fail database validation"
        put:
          url: "/recipients/branches/{{ id }}/registration"
          json:
            id: "invalid UUID"
          headers:
            Authorization: "Bearer {{$processEnvironment.AUTH_TOKEN}}"
          expect:
            - statusCode 400
            - hasHeader: api-version
            - hasProperty: error
            - equals:
                error: "validation/id"
        think: 3

      - log: "Delete from /recipients/branches/{id}/registration with invalid token"
        delete:
          url: "/recipients/branches/{{ id }}/registration"
          headers:
            Authorization: "Bearer invalid"
          expect:
            - statusCode 401
            - hasHeader: api-version
            - hasProperty: error
            - equals:
                error: "authentication-required"
        think: 3

      - log: "Bad url that doesn't exist"
        get:
          url: "/this/path/does/not/exist"
          headers:
            Authorization: "Bearer {{$processEnvironment.AUTH_TOKEN}}"
          expect:
            - statusCode 404
        think: 3

      - log: "Authorization missing from post to /recipients/branches/{id}/registration"
        post:
          url: "/recipients/branches/{{ id }}/registration"
          json:
            nonexistent: "invalid"
          expect:
            - statusCode 401
            - hasHeader: api-version
            - hasProperty: error
            - equals:
                error: "authentication-required"
        think: 3

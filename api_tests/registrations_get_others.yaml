# ********RoostGPT********
# Test generated by RoostGPT for test credential-wallet-rest-assured using AI Type Azure Open AI and AI Model roost-gpt4-32k

# Test generated for /recipients/branches/{id}/registrations_get for http method type GET in artillery framework
# RoostTestHash=49b35fa9c1



# ********RoostGPT********
config:
  target: "{{ $processEnvironment.API_HOST }}"
  processor: "./artillery_functions.js"
  environments:
    staging:
      target: "{{ $processEnvironment.API_HOST }}"
      phases:
        - duration: 60
          arrivalRate: 5
  plugins:
    expect: {}
  payload:
   path: "registrations_get_others.csv"
   fields:
     - "recipient_branch_id"
     - "credential_url"
     - "size"
     - "offset"
  defaults:
    headers:
      Token: "{{ $processEnvironment.AUTH_TOKEN }}"
   
scenarios:

  # Scenario: Get Registrations for Recipient Branch handling failure cases
  - name: "Scenario 01 - Non Success responses with different failure cases"
    flow:
      # Invalid endpoint - non-existent Recipient Branch
      - get:
          url: "/recipients/branches/invalid_id/registrations"
          headers: 
            Token: "{{ $processEnvironment.AUTH_TOKEN }}"  
          expect: 
            - statusCode: 404 # Expects a failure status code as Provided id is invalid.
          think: 2

      # Invalid recipient branch id - unformatted
      - get: 
          url: "/recipients/branches/123-abcd-xyz-345/registrations"
          headers: 
            Token: "{{ $processEnvironment.AUTH_TOKEN }}"  
          expect: 
            - statusCode: 404 # Expects a failure status code as the id provided is unformatted/malformatted
          think: 2

      # Valid id in wrong format (integer instead of string) - This will consider integer as string and find the results if exist else return empty/notfound response
      - get:
          url: "/recipients/branches/1234567/registrations"
          headers: 
            Token: "{{ $processEnvironment.AUTH_TOKEN }}"  
          expect: 
            - statusCode: 200
            - hasProperty: "data"
            - equals:
                - "data[0].recipient_branch_id"
                - "1234567"

          think: 2
          
      # Valid id in correct format but non-existant id in the data set so expecting 404 not found response
      - get:
          url: "/recipients/branches/9debc64f-3f9d-4a16-97f3-11e63b343bd8/registrations"
          headers: 
            Token: "{{ $processEnvironment.AUTH_TOKEN }}"  
          expect: 
            - statusCode: 404 # Expects a failure status code as there is no data found with the provided id.

          think: 2

      # Testing endpoint with auth token missing from headers - this should fail as auth token required in headers
      - get:
          url: "/recipients/branches/497f6eca-6276-4993-bfeb-53cbbbba6f08/registrations"
          headers: {} # no auth token here
          expect:
            - statusCode: 403 # expect forbidden status when auth token not provided
          think: 2

      # Invalid auth token in headers - this should fail as wrong auth token provided in header
      - get:
          url: "/recipients/branches/5d4e493b-e7a2-41e2-8688-395a393531dd/registrations"
          headers: 
            Token: "Invalid_token_here"  
          expect: 
            - statusCode: 403 # Expects a failure forbidden status code as wrong Auth token provided.
          think: 2

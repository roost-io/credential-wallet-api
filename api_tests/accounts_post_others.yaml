# Test generated by RoostGPT for test credential-wallet-rest-assured using AI Type Azure Open AI and AI Model roost-gpt4-32k


# RoostTestHash=53e96f9805

config:
  target: "{{ $processEnvironment.API_HOST }}"
  plugins:
    expect: {}
  payload:
    path: "accounts_post_others.csv"
    fields:
      - email
    order: sequence
    skipHeader: true

scenarios:
  - name: "Unhappy path cases"
    flow:
      - post:
          url: "/accounts"
          beforeRequest: 'log("Sending invalid request with no body")'
          headers:
            commit-hash: "abcdefg"
          expect:
            - statusCode: 400
            - hasProperty: "error"
            - hasProperty: "description"
          think: 1

      - post:
          url: "/accounts"
          beforeRequest: 'log("Sending request with invalid email format")'
          json:
            email: "invalid email"
          headers:
            commit-hash: "abcdefg"
          expect:
            - statusCode: 400
            - hasProperty: "error"
            - hasProperty: "description"
            - equals: ["error", "validation/email-pattern"]
          think: 1

      - post:
          beforeRequest: 'log("Sending authorized request with valid token but invalid url")'
          json:
            email: "valid_email@test.com"
          headers:
            commit-hash: "abcdefg"
            Token: "{{ $processEnvironment.AUTH_TOKEN }}"
          url: "/nonexistent-url"
          expect:
            - statusCode: 404
          think: 1

      - post:
          url: "/accounts"
          beforeRequest: 'log("Sending request with missing commit-hash header")'
          json:
            email: "valid_email@test.com"
          expect:
            - statusCode: 400
            - hasProperty: ["error"]
            - hasProperty: ["description"]
          think: 1

      - get:
          url: "/accounts"
          beforeRequest: 'log("Unauthorized GET request")'
          expect:
            - statusCode: 401 
          think: 1
